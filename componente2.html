<style>
    #cont {
        gap: 10px;
        display: flex;
        flex-direction: row;
        flex-wrap: wrap;
        align-content: space-around;
        justify-content: space-between;
        align-items: center;
    }
</style>

<componente2>
    <p>This is the main component, which loads data from an external API, and generates dynamically as many Card
        components as needed. Each of these card component has an image component and a circle component. The card
        component takes the url attribute and passes it to tthe image component, which renders it. On the other hand,
        the main component sets an own color css variable, which is used by the circle component to change its color.
    </p>
    <button class="boton1"> add</button>
    <button class="changeValBut"> set random color to css variable</button>
    <button class="next">next</button>
    <button class="prev">prev</button>
    <input class="input1">
    <input class="input2">
    <div id="cont">
        <!-- <app-componente1 color="red" randomvar="{{varofcompo2}}" onload="alert(1)"></app-componente1>
        <app-componente1 color="purple"></app-componente1>
        <app-componente1></app-componente1>
        <app-componente1></app-componente1>
        <app-componente1></app-componente1> -->
    </div>
</componente2>



<script>
    class Componente2 extends Component {

        constructor() {

            super()
            this.setAttribute("varofcompo2", "holissss")

            this.$("input.input1").onkeyup = e => this.handleInputOnChange(e, 1)
            this.$("input.input2").onkeyup = e => this.handleInputOnChange(e, 2)



            this.$(".boton1").onclick = e => this.handleClick(e)
            this.$(".changeValBut").onclick = e => {
                this.setCSSVariable("color-of-tooltip", randomColor())
            }

            this.$(".next").onclick = e => {
                if (this.cards) {
                    this.loadPageOfResults(this.cards.info.next)
                }
            }

            this.$(".prev").onclick = e => {
                if (this.cards) {
                    this.loadPageOfResults(this.cards.info.prev)
                }
            }
            this.loadPageOfResults("https://rickandmortyapi.com/api/character")

        }
        handleInputOnChange(e, which) {
            // console.log(e.target)
            this.setAttribute("text" + which, e.target.value)
        }
        async loadPageOfResults(url) {
            this.cards = await getDataFromAPI(url)
            console.log(this.cards.info)
            if (!this.cards.info.next) this.$(".next").style.display = "none"
            else this.$(".next").style.display = "block"
            if (!this.cards.info.prev) this.$(".prev").style.display = "none"
            else this.$(".prev").style.display = "block"

            this.createCards()


        }



        async createCards() {
            this.$("#cont").innerHTML = ""
            for (let item of this.cards.results) {
                let newCompo1 = app.createComponent("<app-componente1 text1='{{text1}}' text2='{{text2}}' item='" + escape(JSON.stringify(item)) + "'/>")
                this.$("#cont").appendChild(newCompo1)
            }
        }
        handleClick(e) {
            let newCompo1 = app.createComponent("<app-componente1 text1='{{text1}}' text2='{{text2}}' item='" + escape(JSON.stringify({})) + "'/>")
            this.$("#cont").appendChild(newCompo1)
        }


    }
    customElements.define("app-componente2", Componente2)
</script>